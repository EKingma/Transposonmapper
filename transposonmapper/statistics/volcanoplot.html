<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>transposonmapper.statistics.volcanoplot API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>transposonmapper.statistics.volcanoplot</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import os, sys

import matplotlib.pyplot as plt


from transposonmapper.statistics.volcano_helpers import apply_stats,  info_from_datasets, make_datafile

def volcano(path_a, filelist_a, path_b, filelist_b, variable=&#39;read_per_gene&#39;, significance_threshold=0.01, normalize=True, trackgene_list=[], figure_title=&#34;&#34;):
    &#34;&#34;&#34;This script creates a volcanoplot to show the significance of fold change between two datasets.
    It is based on this website:
        - https://towardsdatascience.com/inferential-statistics-series-t-test-using-numpy-2718f8f9bf2f
        - https://www.statisticshowto.com/independent-samples-t-test/

    Code for showing gene name when hovering over datapoint is based on:
        - https://stackoverflow.com/questions/7908636/possible-to-make-labels-appear-when-hovering-over-a-point-in-matplotlib

    T-test is measuring the number of standard deviations our measured mean is from the baseline mean, while taking into
    account that the standard deviation of the mean can change as we get more data
    This creates a volcano plot that shows the fold change between two libraries and the corresponding p-values.
    
    The fold change is determined by the mean of dataset b (experimental set) divided by the mean of dataset a (reference set).
    The datasets can be of different length.
    P-value is determined based on the student t-test (scipy.stats.ttest_ind).

    NOTE:
        The fold change is determined by the ratio between the reference and the experimental dataset.
        When one of the datasets is 0, this is false results for the fold change.
        To prevent this, the genes with 0 insertions are set to have 5 insertions, and the genes with 0 reads are set to have 25 reads.
        These values are determined in dicussion with the Kornmann lab.

    - Created on Tue Feb 16 14:06:48 2021
    - @author: gregoryvanbeek

 
    Parameters
    ----------
    path_a : str
        paths to location of the datafiles for library a 
    filelist_a : str
        list of the names of the datafiles for library a  located in path_a 
    path_b : str
        paths to location of the datafiles for library b
    filelist_b : str
        list of the names of the datafiles for  library b located in path_b 
    variable : str, optional
        tn_per_gene, read_per_gene or Nreadsperinsrt , by default &#39;read_per_gene&#39;
    significance_threshold : float, optional
        Threshold value above which the fold change is regarded significant, only for plotting, by default 0.01
    normalize : bool, optional
        Whether to normalize variable. If set to True, each gene is normalized based on the total count in each dataset (i.e. each file in filelist_)
        , by default True
    trackgene_list : list, optional
        Enter a list of gene name(s) which will be highlighted in the plot (e.g. [&#39;cdc42&#39;, &#39;nrp1&#39;]), by default []
    figure_title : str, optional
        The title of the figure if not empty, by default &#34;&#34;

    Ouputs:
    ---------
        - volcano_df: pandas dataframe containing:
            - gene_names
            - fold change
            - t statistic
            - p value
            - whether p value is above threshold
        - volcanoplot with the log2 fold change between the two libraries and the -log10 p-value.

    &#34;&#34;&#34;

### Making the whole datafile name 

    datafiles_list_a,datafiles_list_b=make_datafile(path_a,filelist_a,path_b,filelist_b)


### Extract information from datasets

    variable_a_array,variable_b_array,volcano_df,tnread_gene_a,_=info_from_datasets(datafiles_list_a,datafiles_list_b,variable,normalize)

### APPLY stats.ttest_ind(A,B)
    volcano_df=apply_stats(variable_a_array,variable_b_array,significance_threshold,volcano_df)

   


### Volcanoplot
    print(&#39;Plotting: %s&#39; % variable)

    fig = plt.figure(figsize=(19.0,9.0))#(27.0,3))
    grid = plt.GridSpec(1, 1, wspace=0.0, hspace=0.0)
    ax = plt.subplot(grid[0,0])

    colors = {False:&#39;black&#39;, True:&#39;red&#39;} # based on p-value significance 
    sc = ax.scatter(x=volcano_df[&#39;fold_change&#39;], y=volcano_df[&#39;p_value&#39;], alpha=0.4, marker=&#39;.&#39;, c=volcano_df[&#39;significance&#39;].apply(lambda x:colors[x]))
    ax.grid(True, which=&#39;major&#39;, axis=&#39;both&#39;, alpha=0.4)
    ax.set_xlabel(&#39;Log2 FC&#39;)
    ax.set_ylabel(&#39;-1*Log10 p-value&#39;)
    if not figure_title == &#34;&#34;:
        ax.set_title(variable + &#34; - &#34; + figure_title)
    else:
        ax.set_title(variable)
    ax.scatter(x=[],y=[],marker=&#39;.&#39;,color=&#39;black&#39;, label=&#39;p-value &gt; {}&#39;.format(significance_threshold)) #set empty scatterplot for legend
    ax.scatter(x=[],y=[],marker=&#39;.&#39;,color=&#39;red&#39;, label=&#39;p-value &lt; {}&#39;.format(significance_threshold)) #set empty scatterplot for legend
    ax.legend()
    if not trackgene_list == []:
        genenames_array = volcano_df[&#39;gene_names&#39;].to_numpy()
        for trackgene in trackgene_list:
            trackgene = trackgene.upper()
            if trackgene in genenames_array:
                trackgene_index = tnread_gene_a.loc[tnread_gene_a[&#39;gene_names&#39;] == trackgene].index[0]
                trackgene_annot = ax.annotate(volcano_df.iloc[trackgene_index,:][&#39;gene_names&#39;], (volcano_df.iloc[trackgene_index,:][&#39;fold_change&#39;], volcano_df.iloc[trackgene_index,:][&#39;p_value&#39;]),
                            size=10, c=&#39;green&#39;, bbox=dict(boxstyle=&#34;round&#34;, fc=&#34;w&#34;))
                trackgene_annot.get_bbox_patch().set_alpha(0.6)
            else:
                print(&#39;WARNING: %s not found&#39; % trackgene)
        


    names = volcano_df[&#39;gene_names&#39;].to_numpy()
    annot = ax.annotate(&#34;&#34;, xy=(0,0), xytext=(20,20),textcoords=&#34;offset points&#34;,
                        bbox=dict(boxstyle=&#34;round&#34;, fc=&#34;w&#34;),
                        arrowprops=dict(arrowstyle=&#34;-&gt;&#34;))
    annot.set_visible(False)


    
    def update_annot(ind):
    
        pos = sc.get_offsets()[ind[&#34;ind&#34;][0]]
        annot.xy = pos
        # text = &#34;{}, {}&#34;.format(&#34; &#34;.join(list(map(str,ind[&#34;ind&#34;]))), 
        #                         &#34; &#34;.join([names[n] for n in ind[&#34;ind&#34;]]))
        text = &#34;{}&#34;.format(&#34; &#34;.join([names[n] for n in ind[&#34;ind&#34;]]))
        annot.set_text(text)
        # annot.get_bbox_patch().set_facecolor(cmap(norm(c[ind[&#34;ind&#34;][0]])))
        # annot.get_bbox_patch().set_alpha(0.4)


    def hover(event):
        vis = annot.get_visible()
        if event.inaxes == ax:
            cont, ind = sc.contains(event)
            if cont:
                update_annot(ind)
                annot.set_visible(True)
                fig.canvas.draw_idle()
            else:
                if vis:
                    annot.set_visible(False)
                    fig.canvas.draw_idle()
                    
    fig.canvas.mpl_connect(&#34;motion_notify_event&#34;, hover)


## return function
    return(volcano_df)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="transposonmapper.statistics.volcanoplot.volcano"><code class="name flex">
<span>def <span class="ident">volcano</span></span>(<span>path_a, filelist_a, path_b, filelist_b, variable='read_per_gene', significance_threshold=0.01, normalize=True, trackgene_list=[], figure_title='')</span>
</code></dt>
<dd>
<div class="desc"><p>This script creates a volcanoplot to show the significance of fold change between two datasets.
It is based on this website:
- <a href="https://towardsdatascience.com/inferential-statistics-series-t-test-using-numpy-2718f8f9bf2f">https://towardsdatascience.com/inferential-statistics-series-t-test-using-numpy-2718f8f9bf2f</a>
- <a href="https://www.statisticshowto.com/independent-samples-t-test/">https://www.statisticshowto.com/independent-samples-t-test/</a></p>
<p>Code for showing gene name when hovering over datapoint is based on:
- <a href="https://stackoverflow.com/questions/7908636/possible-to-make-labels-appear-when-hovering-over-a-point-in-matplotlib">https://stackoverflow.com/questions/7908636/possible-to-make-labels-appear-when-hovering-over-a-point-in-matplotlib</a></p>
<p>T-test is measuring the number of standard deviations our measured mean is from the baseline mean, while taking into
account that the standard deviation of the mean can change as we get more data
This creates a volcano plot that shows the fold change between two libraries and the corresponding p-values.</p>
<p>The fold change is determined by the mean of dataset b (experimental set) divided by the mean of dataset a (reference set).
The datasets can be of different length.
P-value is determined based on the student t-test (scipy.stats.ttest_ind).</p>
<h2 id="note">Note</h2>
<p>The fold change is determined by the ratio between the reference and the experimental dataset.
When one of the datasets is 0, this is false results for the fold change.
To prevent this, the genes with 0 insertions are set to have 5 insertions, and the genes with 0 reads are set to have 25 reads.
These values are determined in dicussion with the Kornmann lab.</p>
<ul>
<li>Created on Tue Feb 16 14:06:48 2021</li>
<li>@author: gregoryvanbeek</li>
</ul>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>path_a</code></strong> :&ensp;<code>str</code></dt>
<dd>paths to location of the datafiles for library a</dd>
<dt><strong><code>filelist_a</code></strong> :&ensp;<code>str</code></dt>
<dd>list of the names of the datafiles for library a
located in path_a</dd>
<dt><strong><code>path_b</code></strong> :&ensp;<code>str</code></dt>
<dd>paths to location of the datafiles for library b</dd>
<dt><strong><code>filelist_b</code></strong> :&ensp;<code>str</code></dt>
<dd>list of the names of the datafiles for
library b located in path_b</dd>
<dt><strong><code>variable</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>tn_per_gene, read_per_gene or Nreadsperinsrt , by default 'read_per_gene'</dd>
<dt><strong><code>significance_threshold</code></strong> :&ensp;<code>float</code>, optional</dt>
<dd>Threshold value above which the fold change is regarded significant, only for plotting, by default 0.01</dd>
<dt><strong><code>normalize</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Whether to normalize variable. If set to True, each gene is normalized based on the total count in each dataset (i.e. each file in filelist_)
, by default True</dd>
<dt><strong><code>trackgene_list</code></strong> :&ensp;<code>list</code>, optional</dt>
<dd>Enter a list of gene name(s) which will be highlighted in the plot (e.g. ['cdc42', 'nrp1']), by default []</dd>
<dt><strong><code>figure_title</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The title of the figure if not empty, by default ""</dd>
</dl>
<h2 id="ouputs">Ouputs:</h2>
<pre><code>- volcano_df: pandas dataframe containing:
    - gene_names
    - fold change
    - t statistic
    - p value
    - whether p value is above threshold
- volcanoplot with the log2 fold change between the two libraries and the -log10 p-value.
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def volcano(path_a, filelist_a, path_b, filelist_b, variable=&#39;read_per_gene&#39;, significance_threshold=0.01, normalize=True, trackgene_list=[], figure_title=&#34;&#34;):
    &#34;&#34;&#34;This script creates a volcanoplot to show the significance of fold change between two datasets.
    It is based on this website:
        - https://towardsdatascience.com/inferential-statistics-series-t-test-using-numpy-2718f8f9bf2f
        - https://www.statisticshowto.com/independent-samples-t-test/

    Code for showing gene name when hovering over datapoint is based on:
        - https://stackoverflow.com/questions/7908636/possible-to-make-labels-appear-when-hovering-over-a-point-in-matplotlib

    T-test is measuring the number of standard deviations our measured mean is from the baseline mean, while taking into
    account that the standard deviation of the mean can change as we get more data
    This creates a volcano plot that shows the fold change between two libraries and the corresponding p-values.
    
    The fold change is determined by the mean of dataset b (experimental set) divided by the mean of dataset a (reference set).
    The datasets can be of different length.
    P-value is determined based on the student t-test (scipy.stats.ttest_ind).

    NOTE:
        The fold change is determined by the ratio between the reference and the experimental dataset.
        When one of the datasets is 0, this is false results for the fold change.
        To prevent this, the genes with 0 insertions are set to have 5 insertions, and the genes with 0 reads are set to have 25 reads.
        These values are determined in dicussion with the Kornmann lab.

    - Created on Tue Feb 16 14:06:48 2021
    - @author: gregoryvanbeek

 
    Parameters
    ----------
    path_a : str
        paths to location of the datafiles for library a 
    filelist_a : str
        list of the names of the datafiles for library a  located in path_a 
    path_b : str
        paths to location of the datafiles for library b
    filelist_b : str
        list of the names of the datafiles for  library b located in path_b 
    variable : str, optional
        tn_per_gene, read_per_gene or Nreadsperinsrt , by default &#39;read_per_gene&#39;
    significance_threshold : float, optional
        Threshold value above which the fold change is regarded significant, only for plotting, by default 0.01
    normalize : bool, optional
        Whether to normalize variable. If set to True, each gene is normalized based on the total count in each dataset (i.e. each file in filelist_)
        , by default True
    trackgene_list : list, optional
        Enter a list of gene name(s) which will be highlighted in the plot (e.g. [&#39;cdc42&#39;, &#39;nrp1&#39;]), by default []
    figure_title : str, optional
        The title of the figure if not empty, by default &#34;&#34;

    Ouputs:
    ---------
        - volcano_df: pandas dataframe containing:
            - gene_names
            - fold change
            - t statistic
            - p value
            - whether p value is above threshold
        - volcanoplot with the log2 fold change between the two libraries and the -log10 p-value.

    &#34;&#34;&#34;

### Making the whole datafile name 

    datafiles_list_a,datafiles_list_b=make_datafile(path_a,filelist_a,path_b,filelist_b)


### Extract information from datasets

    variable_a_array,variable_b_array,volcano_df,tnread_gene_a,_=info_from_datasets(datafiles_list_a,datafiles_list_b,variable,normalize)

### APPLY stats.ttest_ind(A,B)
    volcano_df=apply_stats(variable_a_array,variable_b_array,significance_threshold,volcano_df)

   


### Volcanoplot
    print(&#39;Plotting: %s&#39; % variable)

    fig = plt.figure(figsize=(19.0,9.0))#(27.0,3))
    grid = plt.GridSpec(1, 1, wspace=0.0, hspace=0.0)
    ax = plt.subplot(grid[0,0])

    colors = {False:&#39;black&#39;, True:&#39;red&#39;} # based on p-value significance 
    sc = ax.scatter(x=volcano_df[&#39;fold_change&#39;], y=volcano_df[&#39;p_value&#39;], alpha=0.4, marker=&#39;.&#39;, c=volcano_df[&#39;significance&#39;].apply(lambda x:colors[x]))
    ax.grid(True, which=&#39;major&#39;, axis=&#39;both&#39;, alpha=0.4)
    ax.set_xlabel(&#39;Log2 FC&#39;)
    ax.set_ylabel(&#39;-1*Log10 p-value&#39;)
    if not figure_title == &#34;&#34;:
        ax.set_title(variable + &#34; - &#34; + figure_title)
    else:
        ax.set_title(variable)
    ax.scatter(x=[],y=[],marker=&#39;.&#39;,color=&#39;black&#39;, label=&#39;p-value &gt; {}&#39;.format(significance_threshold)) #set empty scatterplot for legend
    ax.scatter(x=[],y=[],marker=&#39;.&#39;,color=&#39;red&#39;, label=&#39;p-value &lt; {}&#39;.format(significance_threshold)) #set empty scatterplot for legend
    ax.legend()
    if not trackgene_list == []:
        genenames_array = volcano_df[&#39;gene_names&#39;].to_numpy()
        for trackgene in trackgene_list:
            trackgene = trackgene.upper()
            if trackgene in genenames_array:
                trackgene_index = tnread_gene_a.loc[tnread_gene_a[&#39;gene_names&#39;] == trackgene].index[0]
                trackgene_annot = ax.annotate(volcano_df.iloc[trackgene_index,:][&#39;gene_names&#39;], (volcano_df.iloc[trackgene_index,:][&#39;fold_change&#39;], volcano_df.iloc[trackgene_index,:][&#39;p_value&#39;]),
                            size=10, c=&#39;green&#39;, bbox=dict(boxstyle=&#34;round&#34;, fc=&#34;w&#34;))
                trackgene_annot.get_bbox_patch().set_alpha(0.6)
            else:
                print(&#39;WARNING: %s not found&#39; % trackgene)
        


    names = volcano_df[&#39;gene_names&#39;].to_numpy()
    annot = ax.annotate(&#34;&#34;, xy=(0,0), xytext=(20,20),textcoords=&#34;offset points&#34;,
                        bbox=dict(boxstyle=&#34;round&#34;, fc=&#34;w&#34;),
                        arrowprops=dict(arrowstyle=&#34;-&gt;&#34;))
    annot.set_visible(False)


    
    def update_annot(ind):
    
        pos = sc.get_offsets()[ind[&#34;ind&#34;][0]]
        annot.xy = pos
        # text = &#34;{}, {}&#34;.format(&#34; &#34;.join(list(map(str,ind[&#34;ind&#34;]))), 
        #                         &#34; &#34;.join([names[n] for n in ind[&#34;ind&#34;]]))
        text = &#34;{}&#34;.format(&#34; &#34;.join([names[n] for n in ind[&#34;ind&#34;]]))
        annot.set_text(text)
        # annot.get_bbox_patch().set_facecolor(cmap(norm(c[ind[&#34;ind&#34;][0]])))
        # annot.get_bbox_patch().set_alpha(0.4)


    def hover(event):
        vis = annot.get_visible()
        if event.inaxes == ax:
            cont, ind = sc.contains(event)
            if cont:
                update_annot(ind)
                annot.set_visible(True)
                fig.canvas.draw_idle()
            else:
                if vis:
                    annot.set_visible(False)
                    fig.canvas.draw_idle()
                    
    fig.canvas.mpl_connect(&#34;motion_notify_event&#34;, hover)


## return function
    return(volcano_df)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="transposonmapper.statistics" href="index.html">transposonmapper.statistics</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="transposonmapper.statistics.volcanoplot.volcano" href="#transposonmapper.statistics.volcanoplot.volcano">volcano</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>